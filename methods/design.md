# 设计最佳实践

*与 AI 协作进行架构和设计的方法*

## 概述

在 Vibe Coding 模式下，设计阶段是人类创造力与 AI 能力协同发挥的关键时刻。良好的设计不仅要满足功能需求，还需考虑如何让系统更"AI友好"，以便后续开发过程中人机协作更加顺畅。

本指南介绍如何在 AI 辅助环境中进行高效的系统设计，确保设计决策既满足业务需求，又能为 AI 辅助实现提供良好基础。

## 核心原则

在设计阶段应遵循以下 Vibe Coding 核心原则：

- **分治与涌现**：设计"AI友好型"架构，明确组件边界
- **意图的同构映射**：确保高层设计意图能映射到具体组件
- **显性契约的适应性突变**：设计明确的接口契约，允许实现细节的演化

## 实践步骤

### 1. 架构愿景构建

**目标**：创建清晰的高层架构视图

**最佳实践**：
- 从高层业务目标推导架构决策
- 使用可视化图表阐明系统组件及关系
- 将非功能需求映射到架构特性
- 利用 AI 辅助探索多种架构方案

**反模式**：
- 过早关注技术细节而非整体结构
- 缺乏对架构决策的明确理由
- 忽视系统未来演化需求

**示例提示**：
```
基于[项目需求]，我需要设计一个系统架构。请：
1. 提出2-3种可行的架构方案
2. 分析每种方案的优缺点
3. 考虑[可扩展性/性能/安全性]等因素
4. 推荐最合适的方案并说明理由
```

### 2. AI友好型组件设计

**目标**：创建边界清晰、职责单一的组件结构

**最佳实践**：
- 遵循单一职责原则设计组件
- 创建明确的接口和数据契约
- 设计"可测试"的组件边界
- 考虑如何让组件设计便于 AI 理解和实现

**反模式**：
- 组件之间存在复杂依赖和循环引用
- 接口定义模糊或过于复杂
- 组件职责不清或过度耦合

**示例提示**：
```
对于[系统组件X]，我需要设计其内部结构：
1. 请提出核心接口定义
2. 设计主要数据结构
3. 明确组件的责任边界
4. 说明该组件与其他组件的交互方式
5. 考虑如何使这个设计便于AI协助实现
```

### 3. 设计决策记录与共识

**目标**：记录关键设计决策及其理由

**最佳实践**：
- 使用架构决策记录(ADR)文档化重要决策
- 利用 AI 评估设计的优缺点和潜在风险
- 创建设计共识文档作为团队参考
- 建立设计变更的评审机制

**反模式**：
- 设计决策没有明确记录
- 缺乏对设计选择的理由说明
- 设计文档与实际实现脱节

**示例提示**：
```
针对[设计决策X]，请帮我：
1. 总结我们选择这个方案的背景和约束
2. 列出我们考虑过的替代方案
3. 分析当前方案的优势和可能的风险
4. 提出相关的实现指南和注意事项
```

### 4. 设计验证与原型

**目标**：验证设计的可行性和适当性

**最佳实践**：
- 创建关键部分的概念验证(POC)
- 利用 AI 生成设计验证测试用例
- 进行早期性能和扩展性评估
- 收集并整合反馈调整设计

**反模式**：
- 跳过验证直接进入全面实现
- 忽略关键技术风险点
- 对设计假设缺乏检验

**示例提示**：
```
为了验证[设计方案X]的可行性，请：
1. 设计一个最小可行的概念验证实验
2. 提出关键的测试场景和预期结果
3. 分析可能的技术风险和缓解策略
4. 建议验证过程中需要收集的关键指标
```

## 成功指标

- 设计文档清晰且团队有共识
- 组件职责和边界定义明确
- 关键设计决策有充分记录
- 设计易于分解为可独立实现的任务

## IDE 实现参考

- [Cursor 实现指南](../ai-ide/cursor/overview.md)
- [Windsurf 实现指南](../ai-ide/windsurf/overview.md)

---

## 延伸阅读

- [需求分析最佳实践](./requirements.md)
- [实现最佳实践](./implementation.md)
- [分治与涌现原则](../principles/golden-rules.md#4-分治与涌现-divide--conquer-for-emergence)
